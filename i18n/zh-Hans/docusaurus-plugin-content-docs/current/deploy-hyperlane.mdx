# å¦‚ä½•å°†æ‚¨çš„é“¾ä¸ Hyperlane è¿æ¥

:::info
æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°½å¿«å°† Hyperlane éƒ¨ç½²åˆ°æ‚¨çš„æ–°é“¾ä¸Šä»¥è¿›è¡Œæµ‹è¯•ï¼Œè€Œä¸æ˜¯ç”Ÿäº§ç¯å¢ƒã€‚è¿™åŒ…æ‹¬æ ¸å¿ƒé‚®ç®±å’Œ ISM åˆçº¦ä»¥åŠæ‚¨è¦æ¡¥æ¥çš„èµ„äº§çš„ warp route åˆçº¦ã€‚

è¦æŸ¥çœ‹å·²æ”¯æŒçš„é“¾ï¼Œè¯·è®¿é—® [Registry](https://github.com/hyperlane-xyz/hyperlane-registry/tree/main/chains)ã€‚

å¦‚æœæ‚¨éœ€è¦ä»»ä½•å¸®åŠ©ï¼Œè¯·åœ¨ Discord ä¸Šçš„ #developers é¢‘é“è”ç³»æˆ‘ä»¬æˆ–[è”ç³»æˆ‘ä»¬](https://forms.gle/KyRTaWvo4XNmNvrq6)ã€‚
:::

## å…ˆå†³æ¡ä»¶

ä»»ä½•äººåªè¦å…·å¤‡ä»¥ä¸‹å·¥ä»¶å’Œèµ„äº§å°±å¯ä»¥å¼€å§‹è¿™ä¸ªå¿«é€Ÿå…¥é—¨æŒ‡å—ï¼š
- ä¸€ä¸ªæ–°çš„ã€è‡ªå®šä¹‰çš„æˆ–é¢„å…ˆå­˜åœ¨çš„ç½‘ç»œï¼ŒåŒ…æ‹¬ä»¥ä¸‹å…ƒæ•°æ®ï¼š
    - é“¾åç§°ï¼Œä¾‹å¦‚ `ethereum`
    - é“¾ IDï¼Œä¾‹å¦‚ `1`
    - RPC URLï¼Œä¾‹å¦‚ `https://eth.llamarpc.com`
- éƒ¨ç½²è€…é’±åŒ…/EOA ç§é’¥æˆ–åŠ©è®°è¯
    - è¿™ä¸ª EOA åº”è¯¥åœ¨æ‚¨çš„è‡ªå®šä¹‰é“¾å’Œä»»ä½•æ‚¨å°†è¦ä¼ é€’æ¶ˆæ¯çš„é“¾ä¸Šéƒ½æœ‰èµ„é‡‘
- [Hyperlane CLI](/docs/reference/cli.mdx)

## 1) Registry

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰é“¾é…ç½®ï¼Œè¿è¡Œï¼š

```bash
hyperlane registry init
```

æŒ‰ç…§æç¤ºè®¾ç½®æ‚¨çš„é“¾å…ƒæ•°æ®ã€‚è®¾ç½®åŒºå—æˆ– gas å±æ€§æ˜¯å¯é€‰çš„ã€‚

ç°åœ¨ï¼Œåœ¨ `$HOME/.hyperlane/chains` ä¸‹ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªä»¥æ‚¨çš„è‡ªå®šä¹‰é“¾åç§°å‘½åçš„æ–°æ–‡ä»¶å¤¹ï¼Œä»¥åŠè¯¥æ–‡ä»¶å¤¹ä¸­åä¸º `metadata.yaml` çš„æ–‡ä»¶ã€‚

<details> 
  <summary>
    `$HOME/.hyperlane/chains/yourchain/metadata.yaml` ä¸­çš„é…ç½®ç¤ºä¾‹å†…å®¹
  </summary>

   ```yaml
    # yaml-language-server: $schema=../schema.json
    blockExplorers:
      - apiUrl: https://explorer.yourchain.com/api
        apiKey: XXXX # æœ‰åŠ©äºé¿å…åˆçº¦éªŒè¯ API çš„é€Ÿç‡é™åˆ¶
        family: etherscan #æ‚¨ä½¿ç”¨çš„æµè§ˆå™¨ï¼Œä¹Ÿæ”¯æŒ routescan æˆ– blockscout
        name: Chainscan
        url: https://explorer.yourchain.com
    chainId: 171717
    displayName: Chain Name
    domainId: 171717
    isTestnet: true # å¯é€‰
    name: yourchain
    nativeToken:
      name: Ether
      symbol: ETH
      decimals: 18
    protocol: ethereum
    rpcUrls:
      - http: https://hyper-lane-docs.rpc.caldera.xyz/http
    ```
</details>

## 2) Core

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬é…ç½®ã€éƒ¨ç½²å’Œæµ‹è¯•æ‚¨çš„è‡ªå®šä¹‰é“¾çš„æ ¸å¿ƒåˆçº¦ã€‚

### åˆå§‹åŒ–é…ç½®

1. ä»æ‚¨çš„æœ¬åœ°ç¯å¢ƒï¼Œå°†æ‚¨çš„å·²æœ‰èµ„é‡‘çš„éƒ¨ç½²è€…åœ°å€çš„ç§é’¥æˆ–åŠ©è®°è¯è®¾ç½®ä¸º `HYP_KEY`ã€‚ä¾‹å¦‚ï¼š`export HYP_KEY='<YOUR_PRIVATE_KEY>'`
2. ä»åŒä¸€ä¸ªç»ˆç«¯å®ä¾‹ï¼Œè¿è¡Œï¼š
    
  ```bash
  hyperlane core init
  ```
<details>
  <summary>
    éƒ¨ç½²é…ç½®å°†è¢«å†™å…¥ `./configs/core-config.yaml`
  </summary>
  
  ```yaml
  owner: "0x16F4898F47c085C41d7Cc6b1dc72B91EA617dcBb"
  defaultIsm:
    type: trustedRelayerIsm
    relayer: "0x16F4898F47c085C41d7Cc6b1dc72B91EA617dcBb"
  defaultHook:
    type: merkleTreeHook
  requiredHook:
    owner: "0x16F4898F47c085C41d7Cc6b1dc72B91EA617dcBb"
    type: protocolFee
    beneficiary: "0x16F4898F47c085C41d7Cc6b1dc72B91EA617dcBb"
    maxProtocolFee: "100000000000000000"
    protocolFee: "0"
  ```
    
</details>


### éƒ¨ç½²åˆçº¦

è¦éƒ¨ç½²åˆçº¦ï¼Œè¿è¡Œï¼š

```bash
hyperlane core deploy
```

ä½¿ç”¨ç®­å¤´å’Œå›è½¦é”®ä»ä¸»ç½‘åˆ—è¡¨åº•éƒ¨é€‰æ‹©æ‚¨çš„è‡ªå®šä¹‰é“¾ã€‚
æ‰€æœ‰åˆçº¦éƒ¨ç½²éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚
<details> 
  <summary>
    åœ¨ `$HOME/.hyperlane/chains` ä¸‹ï¼Œæ‚¨ä¼šæ‰¾åˆ°ä¸€ä¸ªä»¥æ‚¨çš„è‡ªå®šä¹‰é“¾åç§°å‘½åçš„æ–°æ–‡ä»¶å¤¹ï¼Œä»¥åŠè¯¥æ–‡ä»¶å¤¹ä¸­åä¸º `addresses.yaml` çš„æ–‡ä»¶
  </summary>
  ```yaml
    staticMerkleRootMultisigIsmFactory: "0x6906cb4741d3E2322E9f9aA645DfC8AB6F122c47"
    staticMessageIdMultisigIsmFactory: "0x3CE97a32d9C8294691cBd2baC09B078EDa75c429"
    staticAggregationIsmFactory: "0x81f969fDBF48278Ce09685Ce48e03388B6785aF4"
    staticAggregationHookFactory: "0x3d864A3c25F61E3c3A7d02e980453A6E1f0a92A6"
    domainRoutingIsmFactory: "0xC4c01f7B03f0fFa77A0265C600dEF7Ad28BCa5A2"
    proxyAdmin: "0xABb7175d5F123172E7B7Fa467CC9fE4C2FEdb942"
    mailbox: "0x5F58d75A9caDE4e2b191313223978dF049f93b81"
    interchainAccountRouter: "0x43c0745b0dE9Cb780816a24ddE63d79Ca99B5dE8"
    interchainAccountIsm: "0x9C96dC8f4257413225d6B5C47d1afbafc39B269F"
    validatorAnnounce: "0xE3bd39BF92DB385dE6313D6070b035bD934378CB"
    testRecipient: "0xa58462b1943Be1469Ed58db690C78583BA34Fd2E"
    ```
</details>
    
### å‘é€æµ‹è¯•æ¶ˆæ¯

è¦å‘é€æµ‹è¯•æ¶ˆæ¯ï¼Œè¿è¡Œï¼š

```bash
hyperlane send message --relay
```

`--relay` æ ‡å¿—æ˜¯å¯é€‰çš„ï¼Œå®ƒå°†æ¶ˆæ¯ä¼ é€’åˆ°ç›®æ ‡é“¾ã€‚

æ‚¨ä¹Ÿå¯ä»¥åœ¨åå°è¿è¡Œä¸€ä¸ªä¸­ç»§å™¨ï¼š

```bash
hyperlane relayer --chains yourchain,sepolia
```

:::note
**ğŸ‰ æ­å–œï¼æ‚¨å·²æˆåŠŸå‘æ‚¨çš„è‡ªå®šä¹‰é“¾å‘é€äº†æ¶ˆæ¯**
:::


## 3) Warp Route

ç°åœ¨æ‚¨çš„é“¾ä¸Šå·²ç»æœ‰äº† Hyperlane é‚®ç®±å’Œæ ¸å¿ƒåˆçº¦ï¼Œæ˜¯æ—¶å€™åœ¨æ‚¨çš„é“¾å’Œä»»ä½•å…¶ä»– Hyperlane é“¾ä¹‹é—´è®¾ç½®ä»£å¸æ¡¥æ¥äº†ã€‚

ç»§ç»­æŸ¥çœ‹ [éƒ¨ç½² Warp Route](/docs/guides/deploy-warp-route.mdx) æ–‡æ¡£äº†è§£æ›´å¤šè¯¦æƒ…ã€‚

## 4) æäº¤åˆ° Registry

å¦‚æœæ‚¨å¸Œæœ›å…¶ä»–é“¾ä¹Ÿèƒ½ä¸æ‚¨è¿æ¥å¹¶å°†å…¶æŠ•å…¥ç”Ÿäº§ï¼Œè¯·æäº¤ registry PRã€‚

### ç¡®ä¿ä¿¡æ¯å®Œæ•´
ç¡®ä¿æ‚¨çš„å…ƒæ•°æ®å®Œæ•´ï¼š
- åœ¨æ–‡ä»¶å¤¹å†…æ·»åŠ  `logo.svg` æ–‡ä»¶
- åŒ…å«æ ‡è¯†éƒ¨ç½²å›¢é˜Ÿçš„ `Deployer` ä¿¡æ¯
- å¦‚æœé“¾æ˜¯æµ‹è¯•ç½‘ï¼Œåˆ™æŒ‡ç¤º `isTestnet` ä¸º `true`
- å¦‚æœæ‚¨æœ‰ gnosis safe æœåŠ¡ï¼Œæ·»åŠ  api url `gnosisSafeTransactionServiceUrl`
- å¯¹ yaml æ–‡ä»¶è¿›è¡Œ lint å¤„ç†å¹¶æŒ‰å­—æ¯é¡ºåºæ’åº

### æäº¤åˆ° Github

é¦–å…ˆï¼Œå¯¼èˆªåˆ°æ‚¨çš„ registry æœ¬åœ°å®ä¾‹å¹¶æäº¤æ›´æ”¹

```bash
cd ~/.hyperlane && git init && git add . && git commit
```

ç„¶åï¼Œå°†æœ¬åœ° registry ä¸è§„èŒƒ registry åŒæ­¥

```bash
git remote add canonical git@github.com:hyperlane-xyz/hyperlane-registry.git
git pull canonical main --rebase
```

æœ€åï¼Œå°†æœ¬åœ° registry æ¨é€åˆ° github fork å¹¶æäº¤ PRã€‚è¯·åœ¨æ‚¨çš„ PR ä¸­åŒ…å«ä¸€ä¸ª [changeset](https://github.com/changesets/changesets/blob/main/docs/adding-a-changeset.md)ã€‚

:::note
**æ­å–œï¼æ‚¨å·²æˆåŠŸå°† Hyperlane éƒ¨ç½²åˆ°æ‚¨çš„é“¾å¹¶å°†æ‚¨çš„å·¥ä½œæ·»åŠ åˆ° Hyperlane registry**

æ„Ÿè°¢æ‚¨ä¸ºæ— éœ€è®¸å¯çš„äº’æ“ä½œæ€§çš„æœªæ¥åšå‡ºè´¡çŒ® ğŸ«¡
:::

### æŠ•å…¥ç”Ÿäº§
#### ç¤¾åŒºè¿è¡Œçš„åŸºç¡€è®¾æ–½
ä½œä¸ºå…¬å…±äº§å“ï¼ŒHyperlane çš„æ ¸å¿ƒå¼€å‘å›¢é˜Ÿ - Abacus Works - å¯ä»¥å…è´¹å¸®åŠ©æ‚¨å°†ä¸»ç½‘é“¾æŠ•å…¥ç”Ÿäº§ã€‚æ‚¨å¯ä»¥åœ¨ PR ä¸­è¯·æ±‚è¿™ä¸ªæœåŠ¡ï¼Œæ¯ä¸¤å‘¨æ·»åŠ ä¸€æ‰¹æ–°é“¾ã€‚

è¿™åŒ…æ‹¬è¿è¡Œä¸€ä¸ªå°†æ‚¨çš„é“¾è¿æ¥åˆ°ç½‘ç»œçš„ä¸­ç»§å™¨ï¼Œå°†æ‚¨çš„é“¾æ·»åŠ åˆ° [Explorer](https://explorer.hyperlane.xyz/)ï¼Œå¹¶åœ¨æ‚¨çš„é“¾çš„é»˜è®¤éªŒè¯å™¨é›†ä¸­è¿è¡Œä¸€ä¸ªéªŒè¯å™¨ã€‚æ²¡æœ‰æŒç»­çš„æˆæœ¬æˆ–é”å®š - æ‚¨å¯ä»¥éšæ—¶é€‰æ‹©å°†ä¸­ç»§å™¨è¿ç§»åˆ°è‡ªæ‰˜ç®¡é€‰é¡¹æˆ–æ›´æ”¹éªŒè¯å™¨é›†ã€‚

#### è‡ªæ‰˜ç®¡åŸºç¡€è®¾æ–½
åƒ Stride è¿™æ ·å…·æœ‰ devops ç»éªŒçš„é“¾é€‰æ‹©è¿è¡Œè‡ªå·±çš„ä¸­ç»§å™¨ã€‚è™½ç„¶è¿™ç¡®å®æœ‰ä¸€äº›è¿è¥è´Ÿæ‹…ï¼Œä½†è¿™å…è®¸ä»–ä»¬æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥æ›´å¿«åœ°æ·»åŠ æ–°é“¾ã€‚æ­¤å¤–ï¼Œä»–ä»¬å¯ä»¥é€‰æ‹©è®¾ç½®æˆ–è¡¥è´´ä¸ä¸­ç»§ç›¸å…³çš„è·¨é“¾ gas æˆæœ¬ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [è¿è¥](/docs/operate/relayer/run-relayer.mdx) æ–‡æ¡£ã€‚
