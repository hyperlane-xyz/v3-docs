# 时序图

以下是跨链消息在目标链上被验证和传递的简化时序图。

:::info

- 如果接收者没有实现 `ISpecifiesInterchainSecurityModule` 或 `recipient.interchainSecurityModule()` 返回 `address(0)`，将使用 [Mailbox](../mailbox.mdx) 上配置的默认 ISM 来验证消息。
- 为了清晰起见，这部分内容在时序图中被省略。

:::

```mermaid
sequenceDiagram
    participant Relayer as 中继器
    participant Mailbox as 邮箱
    participant ISM as ISM
    participant Recipient as 接收者

    Relayer-->>ISM: moduleType()
    ISM-->>Relayer: ISM 类型
    Relayer->>Mailbox: process(metadata, message)
    Mailbox-->>Recipient: interchainSecurityModule()
    Recipient-->>Mailbox: ISM 地址
    Mailbox->>ISM: verify(metadata, message)
    ISM-->>Mailbox: true
    Mailbox->>Recipient: handle(origin, sender, body)
```
