# Multisig ISM

_Verify messages using validator signatures_

The `MultisigISM` is one of the most commonly used ISM types. These ISMs verify that `m` of `n` [Validators](../agents/validators.mdx) have attested to the validity of a particular interchain message.

## Multisig Module Types

Based on the following module types, the relayer will encode the appropriately formatted metadata:

```solidity file=<rootDir>/node_modules/@hyperlane-xyz/core/contracts/interfaces/IInterchainSecurityModule.sol#L5-L18

```

For these module types, the metadata is formatted by the relayer as follows:

### MessageIdMultisigIsmMetadata

**Type: `Types.MESSAGE_ID_MULTISIG`**

**Format of metadata:**

- `1st component (len == 32 bytes): Origin merkle tree address`
- `2nd component (len == 32 bytes): Signed checkpoint root`
- `3rd component (len == 4 bytes): Signed checkpoint index`
- `4th component (len == threshold * 65 bytes): Validator signatures`

<!-- ```mermaid block-beta columns 4 a["[32 bytes] Origin merkle tree address"]:2 b["[32 bytes] Signed checkpoint root"]:2 c["[4 bytes] Signed checkpoint index"]:1 block:group:3 d["[65 bytes] Validator signatures"] e["[65 bytes] Validator signatures"] f["[65 bytes] Validator signatures"] end ``` -->

### MerkleRootMultisigIsmMetadata

**Type: `Types.MERKLE_ROOT_MULTISIG`**

**Format of metadata:**

- `1st component (len == 32 bytes) Origin merkle tree address`
- `2nd component (len == 4 bytes) Index of message ID in merkle tree`
- `3rd component (len == 32 bytes) Signed checkpoint message ID`
- `4th component (len == 1024 bytes) Merkle proof`
- `5th component (len == 4 bytes) Signed checkpoint index (computed from proof and index)`
- `6th component (len == threshold * 65 bytes): Validator signatures`

## Interface

`MultisigISMs` must implement the `IMultisigIsm` interface.

```solidity file=<rootDir>/node_modules/@hyperlane-xyz/core/contracts/interfaces/isms/IMultisigIsm.sol

```

## Configure

The hyperlane-monorepo contains [`MultisigISM` implementations](https://github.com/hyperlane-xyz/hyperlane-monorepo/tree/main/solidity/contracts/isms/multisig) (including a [legacy](https://github.com/hyperlane-xyz/hyperlane-monorepo/blob/main/solidity/contracts/isms/multisig/LegacyMultisigIsm.sol) version and more gas-efficient [versions](https://github.com/hyperlane-xyz/hyperlane-monorepo/blob/main/solidity/contracts/isms/multisig/StaticMultisigIsm.sol) deployable via factories) that application developers can deploy off-the-shelf, specifying their desired configuration.

Developers can configure, for each origin chain, a set of `n` Validators.  Alongisde this, a `threshold` must be configured to specify the number of these validator's signatures (`m`) needed to verify a message.

Validator signatures are **not** specific to an ISM. In other words, developers can configure their `MultisigISM` to use **any** validator that's running on Hyperlane.

## Customize

For more specific use cases, developers can fork the abstract `MultisigISM` implementation provided in the Hyperlane monorepo. The primary customization involves implementing the `validatorsAndThreshold()` function.

Custom implementations allow developers to adjust the security model to meet the needs of their application. For example, a custom implementation could vary the number of signatures required, based on the content of the message being verified.
