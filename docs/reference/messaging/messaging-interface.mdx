import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

import SimpleMessagingDiagram from '@site/src/diagrams/messaging-simple.md';

# Mailbox

Hyperlaneçš„é€šç”¨æ¶ˆæ¯ä¼ é€’ï¼ˆGMPï¼‰æ¥å£æ˜¯ä»¥ä¸€ç§åä¸ºé‚®ç®±ï¼ˆMailboxï¼‰çš„æ™ºèƒ½åˆçº¦çš„å½¢å¼å®ç°çš„ã€‚è¯¥åˆçº¦å¯¹[message headers](#message-headers)è¿›è¡Œç¼–ç å’Œè§£ç ï¼Œç¡®ä¿å…¨å±€æ¶ˆæ¯çš„[uniqueness](#uniqueness)ï¼Œå¹¶é˜²æ­¢[replay attacks](#replay-protection)ã€‚

<SimpleMessagingDiagram/>

To [**send**](./send.mdx) è·¨é“¾æ¶ˆæ¯ï¼Œè°ƒç”¨`dispatch`å‡½æ•°ã€‚

To [**receive**](./receive.mdx) è¦å®ç°é“¾é—´æ¶ˆæ¯ï¼Œéœ€è¦æ‰§è¡Œ `handle` å‡½æ•°ã€‚

<details>
<summary>`IMailbox` Interface</summary>

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity file=<rootDir>/node_modules/@hyperlane-xyz/core/contracts/interfaces/IMailbox.sol
```

</TabItem>
</Tabs>
</details>

## ä¿¡æ¯å¤´

é‚®ç®±åœ¨é‚®ä»¶æ­£æ–‡å‰åŠ ä¸Šä¸€ä¸ªåŒ…å«ä»¥ä¸‹å­—æ®µçš„æ ‡å¤´ï¼š

- `version`: é‚®ç®±åˆåŒçš„ç‰ˆæœ¬
- `nonce`: ä»ç»™å®šé‚®ç®±å‘é€çš„æ¯ä¸ªé‚®ä»¶çš„å”¯ä¸€æ ‡è¯†ç¬¦
- `origin`: åŸå§‹é“¾çš„åŸŸ
- `sender`: åŸå§‹é“¾ä¸Šå‘é€æ–¹çš„åœ°å€
- `destination`: ç›®æ ‡é“¾çš„åœ°å€
- `recipient`: ç›®æ ‡é“¾ä¸Šæ”¶ä»¶äººçš„åœ°å€

æœ‰å…³æ¶ˆæ¯ç¼–ç çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… [`Message` library](../libraries/message.mdx)ã€‚

## ç‹¬ç‰¹æ€§

å¯¹äºä»ç»™å®šé‚®ç®±å‘é€çš„æ¯ä¸ªæ¶ˆæ¯ï¼Œ`nonce`æ˜¯ä¸€ä¸ªå•ç‹¬é€’å¢çš„æ•´æ•°ã€‚å®ƒåœ¨æ¯æ¬¡å‘é€æ¶ˆæ¯æ—¶é€’å¢ï¼Œä½œä¸ºå…¶ä»–ç›¸åŒæ¶ˆæ¯çš„åˆ†éš”ç¬¦ã€‚

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity file=<rootDir>/node_modules/@hyperlane-xyz/core/contracts/interfaces/IMailbox.sol#L49
```

</TabItem>
<TabItem value="cw" label="CosmWasm">

ğŸš§ å³å°†åˆ°æ¥! ğŸš§

</TabItem>
<TabItem value="sl" label="Sealevel">

ğŸš§ å³å°†åˆ°æ¥! ğŸš§

</TabItem>
</Tabs>

`messageId`æ˜¯ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„æ¶ˆæ¯æ ‡è¯†ç¬¦ï¼Œä»`dispatch`è°ƒç”¨è¿”å›ï¼Œè®¡ç®—ä¸ºæ¶ˆæ¯çš„`keccak256`å“ˆå¸Œå€¼(å¸¦headers)ã€‚

## Replay Protection

é‚®ç®±ç»´æŠ¤ä¸€ä¸ªå·²ç»ä¼ é€’çš„`messageId`å€¼çš„æ˜ å°„ï¼Œä»¥é˜²æ­¢é‡æ’­æ”»å‡»ã€‚å¦‚æœæ¥æ”¶åˆ°çš„æ¶ˆæ¯åŒ…å«å·²ç»å‘é€çš„`messageId`ï¼Œåˆ™ä¼šæ‹’ç»è¯¥æ¶ˆæ¯ã€‚

<Tabs groupId="lang">
<TabItem value="sol" label="Solidity">

```solidity file=<rootDir>/node_modules/@hyperlane-xyz/core/contracts/interfaces/IMailbox.sol#L51
```

</TabItem>
<TabItem value="cw" label="CosmWasm">

ğŸš§ å³å°†åˆ°æ¥! ğŸš§

</TabItem>
<TabItem value="sl" label="Sealevel">

ğŸš§ å³å°†åˆ°æ¥! ğŸš§

</TabItem>
</Tabs>
